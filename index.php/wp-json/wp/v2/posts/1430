{"id":1430,"date":"2023-04-15T04:32:24","date_gmt":"2023-04-15T04:32:24","guid":{"rendered":"http:\/\/localhost:8000\/?p=1430"},"modified":"2023-04-15T04:55:34","modified_gmt":"2023-04-15T04:55:34","slug":"gpt-demystified-how-perplexity-and-entropy-measure-its-ability-to-guess-the-next-word","status":"publish","type":"post","link":"http:\/\/localhost:8000\/index.php\/gpt-demystified-how-perplexity-and-entropy-measure-its-ability-to-guess-the-next-word\/","title":{"rendered":"GPT Demystified: How Perplexity and Entropy Measure Its Ability to Guess the Next Word&#8221;"},"content":{"rendered":"<style>.kb-table-of-content-nav.kb-table-of-content-id_b86856-92 .kb-table-of-content-wrap{padding-top:var(--global-kb-spacing-sm, 1.5rem);padding-right:var(--global-kb-spacing-sm, 1.5rem);padding-bottom:var(--global-kb-spacing-sm, 1.5rem);padding-left:var(--global-kb-spacing-sm, 1.5rem);}.kb-table-of-content-nav.kb-table-of-content-id_b86856-92 .kb-table-of-contents-title-wrap{padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;}.kb-table-of-content-nav.kb-table-of-content-id_b86856-92 .kb-table-of-contents-title{font-weight:regular;font-style:normal;}.kb-table-of-content-nav.kb-table-of-content-id_b86856-92 .kb-table-of-content-wrap .kb-table-of-content-list{font-weight:regular;font-style:normal;margin-top:var(--global-kb-spacing-sm, 1.5rem);margin-right:0px;margin-bottom:0px;margin-left:0px;}<\/style>\n\n\n<h3 class=\"wp-block-heading\">Introduction<\/h3>\n\n\n\n<p>As language models continue to gain popularity, it is important to have a reliable method of measuring their performance.<\/p>\n\n\n\n<p>Perplexity and entropy are commonly used metrics to evaluate the performance of language models, including GPT-3 and GPT-4.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Perplexity: A Measure of Good Guessing<\/h3>\n\n\n\n<p>Perplexity is calculated as the inverse probability of the next word, normalized by the length of the sequence.<\/p>\n\n\n\n<p>Imagine you have a really good friend who loves to play guessing games with you. You close your eyes, and your friend says a word, and you have to guess what word they said. Sometimes, your friend says words that are easy to guess, like &#8220;cat&#8221; or &#8220;dog&#8221;. Other times, they say words that are harder to guess, like &#8220;rhinoceros&#8221; or &#8220;platypus&#8221;.<\/p>\n\n\n\n<p>The game is more fun when you can make better guesses, right? If your friend always says easy words, the game is too easy and not as fun. But if your friend always says hard words, the game is too hard and not as fun either.<\/p>\n\n\n\n<p>Now, imagine that we have a computer program that can play this game too. We give it a bunch of words, and it has to guess the next word in the sequence. Just like you, sometimes the program will guess right, and sometimes it will guess wrong.<\/p>\n\n\n\n<p>Perplexity is a way to measure how good the program is at guessing the next word. It&#8217;s like a score that tells us how often the program makes good guesses. A low perplexity means the program is very good at guessing, and a high perplexity means the program isn&#8217;t very good.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Entropy: A Measure of Difficulty<\/h3>\n\n\n\n<p>Entropy is another way to measure how hard the game is. It&#8217;s like a measure of how hard it is to guess the right answer. If your friend says easy words, the game has low entropy, but if your friend says hard words, the game has high entropy.<\/p>\n\n\n\n<p>So, perplexity and entropy are two different ways of measuring the same thing: how good a program is at guessing the next word, and how hard the guessing game is. When the game is easy, the program has low entropy and low perplexity. But when the game is hard, the program has high entropy and high perplexity.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">How to Calculate Entropy<\/h3>\n\n\n\n<p>Once we have a language model that assigns probabilities to each word, we can compute the entropy of the sequence as follows:<\/p>\n\n\n\n<p>Iterate over each word in the sequence W.<br>For each word, calculate the probability of that word given the previous words in the sequence, using the language model.<br>Use the probability to compute the entropy of that word as follows:<\/p>\n\n\n\n<figure class=\"wp-block-pullquote\"><blockquote><p>H(w_i) = -log2(P(w_i | w_1, \u2026, w_{i-1}))<\/p><\/blockquote><\/figure>\n\n\n\n<p><br>where w_i is the ith word in the sequence, P(w_i | w_1, \u2026, w_{i-1}) is the probability of the ith word given the preceding words, and log2 is the base-2 logarithm.<br>Sum up the entropies for all words in the sequence to get the total entropy of the sequence:<\/p>\n\n\n\n<figure class=\"wp-block-pullquote\"><blockquote><p>H(W) = sum(H(w_i)) for all i<\/p><\/blockquote><\/figure>\n\n\n\n<p><br>The entropy of the sequence gives us a measure of how unpredictable the sequence is according to the language model. A sequence with low entropy is more predictable and has a lower level of uncertainty, while a sequence with high entropy is less predictable and has a higher level of uncertainty.<\/p>\n\n\n\n<p>We calculate the entropy using the formula above, and then calculate the perplexity using the formula <\/p>\n\n\n\n<figure class=\"wp-block-pullquote\"><blockquote><p>Perplexity = 2^H.<\/p><\/blockquote><\/figure>\n\n\n\n<h3 class=\"wp-block-heading\">Cross Entropy: A Measure of Difference<\/h3>\n\n\n\n<p>Cross entropy is a type of entropy that&#8217;s used to compare two probability distributions. To understand the difference between cross entropy and entropy, let&#8217;s go back to the candy jar example. In the example I gave earlier, we were trying to count the number of different colors of candy in the jar. This is like calculating the entropy of the candy jar &#8211; we&#8217;re trying to figure out how much uncertainty there is in the distribution of colors.<\/p>\n\n\n\n<p>Now, let&#8217;s say we have another jar of candy that&#8217;s very similar to the first jar, but we&#8217;re not sure if it&#8217;s exactly the same. We want to compare the distribution of colors in the two jars to see if they&#8217;re similar or different. This is where cross entropy comes in &#8211; we can use cross entropy to compare the distribution of colors in one jar to the distribution of colors in the other jar. The cross entropy will be lower if the two distributions are similar, and higher if they&#8217;re different.<\/p>\n\n\n\n<p>The equation for cross entropy looks like this:<\/p>\n\n\n\n<figure class=\"wp-block-pullquote\"><blockquote><p>Cross entropy = -\u03a3 (p(x) * log(q(x)))<\/p><\/blockquote><\/figure>\n\n\n\n<h3 class=\"wp-block-heading\">The Candy Jar Game: An Analogy for Cross Entropy<\/h3>\n\n\n\n<p>Cross entropy is like a game where you have to guess which candy your friend likes, but your friend keeps changing their mind about which candy they like the most. You keep guessing different candies, and your friend tells you if you&#8217;re getting closer or further away from their current favorite.<\/p>\n\n\n\n<p>The equation for cross entropy is like a way to keep score in this game. The &#8220;p(x)&#8221; part of the equation represents the true probability that your friend will like a certain candy. The &#8220;q(x)&#8221; part of the equation represents the probability that you guessed for that candy.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\"><br>Conclusion<\/h3>\n\n\n\n<p><br>As language models like GPT-3 and GPT-4 become more prevalent, it is essential to have reliable methods to measure their performance. Perplexity and entropy are two common metrics used to evaluate language models.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Key takeaways:<\/h3>\n\n\n\n<ul>\n<li>Perplexity and entropy are two ways to measure the performance of language models.<\/li>\n\n\n\n<li>Perplexity measures how often a language model makes good guesses while entropy measures how hard it is to guess the right answer.<\/li>\n\n\n\n<li>Cross-entropy is used to compare two probability distributions and is a measure of how different they are from each other.<\/li>\n\n\n\n<li>Perplexity and entropy can be used together to provide a more complete picture of a language model&#8217;s performance.<\/li>\n<\/ul>\n","protected":false},"excerpt":{"rendered":"<p>Introduction As language models continue to gain popularity, it is important to have a reliable method of measuring their performance. Perplexity and entropy are commonly used metrics to evaluate the performance of language models, including GPT-3 and GPT-4. Perplexity: A Measure of Good Guessing Perplexity is calculated as the inverse probability of the next word,&hellip;&nbsp;<a href=\"http:\/\/localhost:8000\/index.php\/gpt-demystified-how-perplexity-and-entropy-measure-its-ability-to-guess-the-next-word\/\" class=\"\" rel=\"bookmark\">Read More &raquo;<span class=\"screen-reader-text\">GPT Demystified: How Perplexity and Entropy Measure Its Ability to Guess the Next Word&#8221;<\/span><\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"neve_meta_sidebar":"","neve_meta_container":"","neve_meta_enable_content_width":"","neve_meta_content_width":0,"neve_meta_title_alignment":"","neve_meta_author_avatar":"","neve_post_elements_order":"[\"content\",\"tags\",\"comments\"]","neve_meta_disable_header":"","neve_meta_disable_footer":"","neve_meta_disable_title":"","_themeisle_gutenberg_block_has_review":false,"_ti_tpc_template_sync":false,"_ti_tpc_template_id":""},"categories":[5],"tags":[134,132,135,136,133,131],"_links":{"self":[{"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/posts\/1430"}],"collection":[{"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/comments?post=1430"}],"version-history":[{"count":1,"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/posts\/1430\/revisions"}],"predecessor-version":[{"id":1431,"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/posts\/1430\/revisions\/1431"}],"wp:attachment":[{"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/media?parent=1430"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/categories?post=1430"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost:8000\/index.php\/wp-json\/wp\/v2\/tags?post=1430"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}